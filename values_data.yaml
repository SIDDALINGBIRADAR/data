# Override default security contexts for OpenShift
securityContext:
  runAsUser: 1001960000  # Matches your project's UID range
  fsGroup: 1001960000    # Matches your project's GID range
  runAsGroup: 1001960000 # Matches your project's GID range

# For Airflow 2.0+ with detailed security contexts
securityContexts:
  pod:
    runAsUser: 1001960000
    fsGroup: 1001960000
    runAsGroup: 1001960000
  containers: {}

# Disable default security contexts that might conflict with OpenShift
workers:
  securityContext: {}
  securityContexts:
    pod: {}
    container: {}

scheduler:
  securityContext: {}
  securityContexts:
    pod: {}
    container: {}

webserver:
  securityContext: {}
  securityContexts:
    pod: {}
    container: {}

triggerer:
  securityContext: {}
  securityContexts:
    pod: {}
    container: {}

# Enable RBAC with OpenShift SCC
rbac:
  create: true
  createSCCRoleBinding: true  # This is crucial for OpenShift

# Set UID/GID for specific components
redis:
  uid: 1001960000
  securityContext:
    runAsUser: 1001960000
    runAsGroup: 1001960000

pgbouncer:
  uid: 1001960000
  securityContexts:
    pod:
      runAsUser: 1001960000
      runAsGroup: 1001960000
    container: {}

# For git-sync if enabled
dags:
  gitSync:
    uid: 1001960000
    securityContext:
      runAsUser: 1001960000
      runAsGroup: 1001960000

# Disable persistence if not properly configured for OpenShift
workers:
  persistence:
    enabled: false

triggerer:
  persistence:
    enabled: false

logs:
  persistence:
    enabled: false

dags:
  persistence:
    enabled: false