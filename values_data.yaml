# values-cp.yaml - UAT
image:
  repository: docker.io/siddalingbiradar/apisix # FULL URL to registry
  pullPolicy: IfNotPresent
  tag: v1

deployment:
  mode: decoupled
  role: control_plane
  replicas: 2 # HIGH AVAILABILITY

admin:
  enabled: true
  type: ClusterIP
  # Use existing secret instead of hardcoded credentials
  existingSecret: apisix-secret
  existingSecretAdminKey: admin-token
  existingSecretViewerKey: viewer-token

etcd:
  enabled: true
  replicaCount: 3
  auth:
    rbac:
      create: true  # ENABLE AUTH
      existingSecret: apisix-secret
      existingSecretPasswordKey: etcd-root-password
  persistence:
    enabled: true
    size: 8Gi
    storageClass: "gp3" # OR "standard", "managed-premium" depending on cloud
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi

apisix:
  plugins:
    # ... (Keep your plugin list exactly as is) ...
    - "verify_permission"
    - "verify_jwt"

# Resource limits for CP itself
resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 500m
    memory: 512Mi
